---
import ProjectCard from './ProjectCard.astro';


export interface Project {
    title: string,
    imageSource: string,
    description: string,
    projectNumber: string
    gitHubLink: string
    tags: Array<string>
}

interface Props {
    listItems: Array<Project>
}

const { listItems } = Astro.props;
const itemsPerSlide = 3;
const totalSlides = Math.ceil(listItems.length / itemsPerSlide);
---

<div id="projectsCarousel" class="overflow-hidden">
    <div class="flex transition-transform duration-500 ease-out" id="projectsTrack">
    {
        Array.from({ length: totalSlides }, (_, slideIndex) => {
            const startIdx = slideIndex * itemsPerSlide;
            const endIdx = startIdx + itemsPerSlide;
            const slideProjects = listItems.slice(startIdx, endIdx);
            
            return (
            <div class="min-w-full grid md:grid-cols-3 gap-8 px-2">
                {
                    slideProjects.map((project) => (
                        <ProjectCard projectItem={project}/>
                    ))
                }
            </div>
            );
        })
    }
    </div>
</div>

<button id="prevProjects" class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 bg-orange-600 hover:bg-orange-700 text-white p-3 rounded-full transition-all">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
    </svg>
</button>
<button id="nextProjects" class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 bg-orange-600 hover:bg-orange-700 text-white p-3 rounded-full transition-all">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
    </svg>
</button>


<div class="flex justify-center gap-2 mt-8">
    {
        Array.from({ length: totalSlides }, (_, i) => (
            <button 
                class={`projectsCarousel-indicator w-3 h-3 rounded-full ${i === 0 ? 'bg-orange-600' : 'bg-gray-600'}`}
                data-slide={i}
            />
        ))
    }
    <!-- <button class="project-indicator w-3 h-3 rounded-full bg-orange-600" data-slide="0"></button> -->
    <!-- <button class="project-indicator w-3 h-3 rounded-full bg-gray-600" data-slide="1"></button> -->
</div>

<script>
    let currentProjectSlide = 0;
    const projectsTrack = document.getElementById('projectsTrack');
    const totalProjectSlides = 2;
    const projectIndicators = document.querySelectorAll('.project-indicator');

    function updateProjectCarousel() {
        projectsTrack.style.transform = `translateX(-${currentProjectSlide * 100}%)`;
        projectIndicators.forEach((indicator, index) => {
        if (index === currentProjectSlide) {
            indicator.classList.remove('bg-gray-600');
            indicator.classList.add('bg-orange-600');
        } else {
            indicator.classList.remove('bg-orange-600');
            indicator.classList.add('bg-gray-600');
        }
        });
    }

    document.getElementById('nextProjects').addEventListener('click', () => {
        currentProjectSlide = (currentProjectSlide + 1) % totalProjectSlides;
        updateProjectCarousel();
    });

    document.getElementById('prevProjects').addEventListener('click', () => {
        currentProjectSlide = (currentProjectSlide - 1 + totalProjectSlides) % totalProjectSlides;
        updateProjectCarousel();
    });

    projectIndicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => {
        currentProjectSlide = index;
        updateProjectCarousel();
        });
    });
</script>